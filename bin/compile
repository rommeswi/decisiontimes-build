#!/bin/bash
export "INSTALL_PATH=$1"
export "CACHE_PATH=$2"
export "ENV_PATH=$3"

# We need to export the random seed environment variable
export "RANDOM_SEED=$(cat $ENV_PATH/RANDOM_SEED)"

# Generate decision problems
GENERATE_SCRIPT="$INSTALL_PATH/generate_json.py"

python "$GENERATE_SCRIPT"


# Install removebg
removebg_file="$CACHE_PATH/removebg_cli_v2.0.3_linux.tar.gz"
if [ ! -f ""]; then
    wget -P $CACHE_PATH https://github.com/remove-bg/remove-bg-cli/releases/download/2.0.3/removebg_cli_v2.0.3_linux.tar.gz
else
    echo "-----> removebg already downloaded, skipping download."
fi

mkdir "$CACHE_PATH/removebg/"
tar -xvzf "$removebg_file" -C "$CACHE_PATH/removebg"
export PATH=$PATH:$CACHE_PATH/removebg/dist/

# Generate images
IMAGE_SCRIPT="$INSTALL_PATH/image_script.py"
python "$IMAGE_SCRIPT"
